(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["setting-mitra-deposit-bdba4f17"],{ecef:function(e,t,o){"use strict";o.r(t);var c=o("7a23");const a={class:"col-md-12 col-sm-12"},l={class:"x_panel"},s={class:"x_title"},r={class:"nav navbar-right panel_toolbox"},n=Object(c["createElementVNode"])("i",{class:"fa fa-arrow-left"},null,-1),d=Object(c["createElementVNode"])("i",{class:"fa fa-plus"},null,-1),i=Object(c["createElementVNode"])("div",{class:"clearfix"},null,-1),m={class:"x_content"},b={class:"table-responsive"},p={class:"row"},u={class:"col-sm-6"},O={class:"item form-group"},j={class:"col-md-6 col-sm-6 ps-0"},h={class:"input-group"},V={class:"row"},N={class:"col-sm-12"},g={class:"table-responsive"},f={class:"table table-striped table-bordered"},E=Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"#"),Object(c["createElementVNode"])("th",null,"Code"),Object(c["createElementVNode"])("th",null,"Descriptions"),Object(c["createElementVNode"])("th",null,"Products"),Object(c["createElementVNode"])("th",null,"Amount"),Object(c["createElementVNode"])("th",null,"Last Update"),Object(c["createElementVNode"])("th",null,"Action")])],-1),v={scope:"row"},k=["onClick"],y=Object(c["createElementVNode"])("i",{class:"fa fa-pencil"},null,-1),C=[y],x=["onClick"],B=Object(c["createElementVNode"])("i",{class:"fa fa-trash"},null,-1),w=[B],D={key:0},$=Object(c["createElementVNode"])("td",{colspan:"7",class:"text-center"}," Data tidak ditemukan ",-1),_=[$];function S(e,t,o,y,B,$){const S=Object(c["resolveComponent"])("b-overlay"),F=Object(c["resolveComponent"])("paging-base"),P=Object(c["resolveComponent"])("DepositForm"),q=Object(c["resolveComponent"])("modal-base");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",a,[Object(c["createElementVNode"])("div",l,[Object(c["createElementVNode"])("div",s,[Object(c["createElementVNode"])("h2",null,Object(c["toDisplayString"])(e.$route.query.mitra),1),Object(c["createElementVNode"])("ul",r,[Object(c["createElementVNode"])("li",null,[Object(c["createElementVNode"])("button",{class:"btn btn-sm btn-outline-secondary",type:"button",onClick:t[0]||(t[0]=t=>e.$router.back())},[n,Object(c["createTextVNode"])(" Kembali ")])]),Object(c["createElementVNode"])("li",null,[Object(c["createElementVNode"])("button",{class:"btn btn-sm btn-primary",type:"button",onClick:t[1]||(t[1]=(...e)=>$.addItem&&$.addItem(...e))},[d,Object(c["createTextVNode"])(" Tambah ")])])]),i]),Object(c["createElementVNode"])("div",m,[Object(c["createElementVNode"])("div",b,[Object(c["createElementVNode"])("div",p,[Object(c["createElementVNode"])("div",u,[Object(c["createElementVNode"])("div",O,[Object(c["createElementVNode"])("div",j,[Object(c["createElementVNode"])("div",h,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{type:"text",class:"form-control",placeholder:"cari...","onUpdate:modelValue":t[2]||(t[2]=e=>B.search.q=e),onKeyup:t[3]||(t[3]=Object(c["withKeys"])((...e)=>$.searchData&&$.searchData(...e),["enter"]))},null,544),[[c["vModelText"],B.search.q]]),Object(c["createElementVNode"])("button",{class:"btn btn-primary",onClick:t[4]||(t[4]=(...e)=>$.searchData&&$.searchData(...e))}," Cari ")])])])])]),Object(c["createElementVNode"])("div",V,[Object(c["createElementVNode"])("div",N,[Object(c["createVNode"])(S,{show:B.loading,rounded:"sm"},{default:Object(c["withCtx"])(()=>[Object(c["createElementVNode"])("div",g,[Object(c["createElementVNode"])("table",f,[E,Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(B.data,(t,o)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:o},[Object(c["createElementVNode"])("td",v,Object(c["toDisplayString"])((B.options.current_page-1)*B.options.per_page+o+1),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.code),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.descriptions),1),Object(c["createElementVNode"])("td",null,[t.products?(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],{key:0},Object(c["renderList"])(t.products,e=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{key:e.id},Object(c["toDisplayString"])(e.product_code)+" - "+Object(c["toDisplayString"])(e.product?e.product.name:""),1))),128)):Object(c["createCommentVNode"])("",!0)]),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.$filters.currency(t.amount)),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.updated_at),1),Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("button",{class:"btn btn-sm btn-primary btn-action-list",type:"button","data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Ubah",onClick:e=>$.editItem(t)},C,8,k),Object(c["createElementVNode"])("button",{class:"btn btn-sm btn-action-list btn-danger",onClick:e=>$.removeItem(t)},w,8,x)])]))),128)),B.data.length<=0&&!B.loading?(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",D,_)):Object(c["createCommentVNode"])("",!0)])])])]),_:1},8,["show"])])]),B.data.length>0?(Object(c["openBlock"])(),Object(c["createBlock"])(F,{key:0,modelValue:B.options.current_page,"onUpdate:modelValue":t[5]||(t[5]=e=>B.options.current_page=e),options:B.options},null,8,["modelValue","options"])):Object(c["createCommentVNode"])("",!0)])])]),Object(c["createVNode"])(q,{modelValue:B.modalForm,"onUpdate:modelValue":t[8]||(t[8]=e=>B.modalForm=e),size:"modal-lg"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(P,{codeMitra:e.$route.params.id,onCancel:t[6]||(t[6]=()=>{B.modalForm=!1}),products:B.products,deposit:B.modalData,onSave:t[7]||(t[7]=()=>{$.loadData(),B.modalForm=!1})},null,8,["codeMitra","products","deposit"])]),_:1},8,["modelValue"])])}const F={class:"item form-group"},P=Object(c["createElementVNode"])("label",{class:"col-form-label col-md-3 col-sm-3 label-align",for:"first-name"},[Object(c["createTextVNode"])("Code "),Object(c["createElementVNode"])("span",{class:"required"},"*")],-1),q={class:"col-md-6 col-sm-6"},T={key:0,class:"p-error"},U={class:"item form-group"},I=Object(c["createElementVNode"])("label",{class:"col-form-label col-md-3 col-sm-3 label-align",for:"first-name"},"Descriptions ",-1),M={class:"col-md-6 col-sm-6"},A={class:"item form-group"},L=Object(c["createElementVNode"])("label",{class:"col-form-label col-md-3 col-sm-3 label-align",for:"first-name"},[Object(c["createTextVNode"])("Product "),Object(c["createElementVNode"])("span",{class:"required"},"*")],-1),K={class:"col-md-9 col-sm-9"},z=Object(c["createElementVNode"])("hr",null,null,-1),G=Object(c["createElementVNode"])("div",{class:"ln_solid"},null,-1),J={class:"item form-group"},H={class:"col-md-6 col-sm-6 offset-md-3"},Y=Object(c["createElementVNode"])("button",{type:"submit",class:"btn btn-primary"},"Submit",-1);function Q(e,t,o,a,l,s){const r=Object(c["resolveComponent"])("Field"),n=Object(c["resolveComponent"])("b-form-checkbox"),d=Object(c["resolveComponent"])("b-tab"),i=Object(c["resolveComponent"])("b-tabs"),m=Object(c["resolveComponent"])("Form"),b=Object(c["resolveComponent"])("b-overlay");return Object(c["openBlock"])(),Object(c["createBlock"])(b,{show:e.$store.state.loading,rounded:"sm"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(m,{onSubmit:s.onSubmit,"validation-schema":l.schema,class:"pt-5"},{default:Object(c["withCtx"])(({errors:a})=>[Object(c["createElementVNode"])("div",F,[P,Object(c["createElementVNode"])("div",q,[Object(c["createVNode"])(r,{name:"code",class:Object(c["normalizeClass"])(["form-control",[{"p-error":a.code}]]),modelValue:l.form.code,"onUpdate:modelValue":t[0]||(t[0]=e=>l.form.code=e),type:"text"},null,8,["modelValue","class"]),a.code?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",T," *"+Object(c["toDisplayString"])(a.code),1)):Object(c["createCommentVNode"])("",!0)])]),Object(c["createElementVNode"])("div",U,[I,Object(c["createElementVNode"])("div",M,[Object(c["createVNode"])(r,{name:"descriptions",class:"form-control",modelValue:l.form.descriptions,"onUpdate:modelValue":t[1]||(t[1]=e=>l.form.descriptions=e),type:"text"},null,8,["modelValue"])])]),Object(c["createElementVNode"])("div",A,[L,Object(c["createElementVNode"])("div",K,[Object(c["createVNode"])(i,{"content-class":"mt-3"},{default:Object(c["withCtx"])(()=>[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(o.products,e=>(Object(c["openBlock"])(),Object(c["createBlock"])(d,{title:e.code,key:e.code},{default:Object(c["withCtx"])(()=>[(Object(c["openBlock"])(),Object(c["createBlock"])(n,{onChange:t=>s.selectedAllByGroup(t,e.code),value:e.code,key:e.code},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])(" Pilih Semua ")]),_:2},1032,["onChange","value"])),z,(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.childs,(e,o)=>(Object(c["openBlock"])(),Object(c["createBlock"])(n,{key:o,modelValue:l.selectedProduct,"onUpdate:modelValue":t[2]||(t[2]=e=>l.selectedProduct=e),value:e.code},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e.name),1)]),_:2},1032,["modelValue","value"]))),128))]),_:2},1032,["title"]))),128))]),_:1})])]),G,Object(c["createElementVNode"])("div",J,[Object(c["createElementVNode"])("div",H,[Object(c["createElementVNode"])("button",{class:"btn btn-outline-primary me-2",type:"button",onClick:t[3]||(t[3]=t=>e.$emit("cancel"))}," Cancel "),Y])])]),_:1},8,["onSubmit","validation-schema"])]),_:1},8,["show"])}var R=o("7bb1"),W=o("506a"),X={components:{Form:R["b"],Field:R["a"]},props:{deposit:Object,products:Array,codeMitra:[String,Number]},data(){const e=W["a"]({code:W["b"]().required()});return{id:"",form:{code:"",descriptions:""},selectedProduct:[],addonFields:[],old:{},schema:e}},watch:{deposit:{deep:!0,handler:function(){this.setSelected()}}},methods:{selectedAllByGroup(e,t){if(e){let e=this.products.find(e=>e.code==t);e=e.childs.map(e=>e.code);let o=Object.assign([],this.selectedProduct);this.selectedProduct=e.concat(o)}else{let e=this.products.find(e=>e.code==t);this.selectedProduct=this.selectedProduct.filter(t=>{if(e.childs.indexOf(e)>-1)return t})}},setSelected(){this.form.code=this.deposit.code,this.form.descriptions=this.deposit.descriptions,this.deposit&&this.deposit.products?this.selectedProduct=this.deposit.products.map(e=>e.product_code):this.selectedProduct=[]},onSubmit(e){let t=Object.assign({},e);t.products=this.selectedProduct.map(e=>({code:e}));let o=()=>this.$axios.post(`/mitra/${this.codeMitra}/deposit-group`,t);this.deposit&&this.deposit.id&&(o=()=>this.$axios.put(`/mitra/${this.codeMitra}/deposit-group/${this.deposit.id}`,t)),this.$store.dispatch("loading",!0),o().then(e=>{this.$root.notif(e.message),this.$emit("save")}).catch(e=>{this.$root.notif(e.message,{type:"error",position:"top"})}).finally(()=>{this.$store.dispatch("loading",!1)})}},mounted(){}},Z=o("d959"),ee=o.n(Z);const te=ee()(X,[["render",Q]]);var oe=te,ce={components:{DepositForm:oe},data(){return{modalForm:!1,modalData:{},products:[],data:[],options:{current_page:1,total_row:0,per_page:1},search:{q:""},loading:!1}},mounted(){this.searchData(),this.loadProduct()},computed:{moreParams(){return{page:this.options.current_page,q:this.search.q}}},watch:{"options.current_page":{handler:function(){this.loadData()}}},methods:{searchData(){this.options.current_page=1,this.loadData()},loadProduct(){this.$axios.get(`/mitra/${this.$route.params.id}/deposit-group/products`,{params:this.moreParams}).then(e=>{this.products=e.data.data}).catch(e=>{this.$root.notif(e.message,{type:"error",position:"top"})}).finally(()=>{})},loadData(){this.loading=!0,this.$axios.get(`/mitra/${this.$route.params.id}/deposit-group`,{params:this.moreParams}).then(e=>{this.loading=!1,this.data=e.data.data,this.options.total_row=e.data.meta.total,this.options.per_page=e.data.meta.per_page}).catch(e=>{this.$root.notif(e.message,{type:"error",position:"top"})}).finally(()=>{this.loading=!1})},removeItem(e){let t="Hapus",o=1;this.$swal.fire({width:350,title:"Yakin?",showCancelButton:!0,confirmButtonText:t}).then(t=>{t.isConfirmed&&this._changeStatus(e,o)})},_changeStatus(e,t){let o=Object.assign({},e);o.status=t,this.$axios.delete(`/mitra/${this.$route.params.id}/deposit-group/${e.id}`,o).then(e=>{this.$root.notif(e.message),this.loadData()}).catch(e=>{this.$root.notif(e.message,{type:"error",position:"top"})}).finally(()=>{})},editItem(e){this.modalData=Object.assign({},e),this.modalForm=!0},addItem(){this.modalData={},this.modalForm=!0}}};const ae=ee()(ce,[["render",S]]);t["default"]=ae}}]);